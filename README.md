# Quantum Random Circuits for quantum resource distribution exploration

<!-- ![Badge Status](https://img.shields.io/badge/status-active-brightgreen) -->

This code allows the parallel computation of multipartite non-locality and other properties among the states generated by quantum random circuits (QRC) of a given device.

A 'Results' folder must be created before the computation. The outputs are JSON files containing circuit instructions to reproduce the states, along with other informations such as depth, angles and the degree of violation of the selected inequality.

## Requirements
```
amazon-braket-default-simulator   1.26.0
amazon-braket-schemas             1.22.0
amazon-braket-sdk                 1.86.1
torch                             1.13.1
pandas 
```

## Usage
The following command mustare distributed be executed in each node, changing only the Rank input parameter to specify the role of the node (0 for the master, from 1 to nnodes-1 for the worker nodes). Workers will wait for the start signal from the master.

```
torchrun --nproc_per_node  <number of CPU cores or GPUs in a node>
         --nnodes          <number of nodes involved in the computation>  
         --node_rank       <use 0 for the master node and 1,...,nnodes-1 for other nodes>
         --master_addr     <master node IP addres>
         --master_port     <port for node comunication> 
          QRC_Search.py  <script parameters>

```


### QRC Search paremeters

#### `--q_dev`
- **Description**: Select the quantum device to use.
- **Choices**: 
  - `Clifford`
  - `Clifford+T`
  - `Aria1` (default)
  - `Forte1`
  - `Garnet`
  - `Righetti`
- **Default value**: `Aria1`

#### `--depth`
- **Description**: Depth of the quantum circuit.
- **Type**: Integer
- **Default value**: `None` (default depth is randomly choosen between 10 and 30. Hardcoded at the moment.)

#### `--max_gates`
- **Description**: Maximum number of quantum gates per layer.
- **Type**: Integer
- **Default value**: `2`

#### `--ineq`
- **Description**: Select the quantum inequality to use.
- **Choices**:
  - `svet` (Svetlichny inequality)
  - `mer` (Mermin inequality)
- **Default value**: `svet`

#### `--n_qubits` (Required)
- **Description**: Number of qubits in the quantum circuit.
- **Type**: Integer
- **Required**: Yes

#### `--n_attempts` (Required)
- **Description**: Number of search attempts to run.
- **Type**: Integer
- **Required**: Yes

#### `--n_seeds`
- **Description**: Number of seeds for each attempt.
- **Type**: Integer
- **Default value**: `5`

#### `--gpu`
- **Description**: Add this flag to enable GPU usage.
- **Action**: `store_true`



## Example usage
### Single local node with 4 GPUs
Use 127.0.0.1 as master address to run locally.

```bash
torchrun --nproc_per_node 4 --nnodes 1 --node_rank 0 --master_addr 127.0.0.1 --master_port 12355 \
QRC_Search.py --q_dev Aria1 --depth 25 --max_gates 2 --ineq svet --n_qubits 3 --n_attempts 100 --n_seeds 7 --gpu

